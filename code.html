Zetamac Auto-Tracker with Google Sheets

🚀 Auto-Tracking Zetamac with Google Sheets
⚡ Maximum Automation Setup
This solution provides the highest automation possible without browser extensions:
Auto-starts on page refresh Persists across game sessions Auto-syncs to Google Sheets One-time setup only 
🚀 Maximum Automation Features
* Auto-restart: Automatically restarts tracking when you refresh the page
* Persistent settings: Remembers your Google Sheet URL
* Background sync: Syncs data every 30 seconds automatically
* Smart detection: Detects new games and question changes instantly
* Zero maintenance: Once set up, runs completely automatically
📊 Enhanced Data Tracking
* Operation analysis: Tracks +, -, ×, ÷ performance separately
* Response timing: Individual question solve times
* Accuracy metrics: Right/wrong answer tracking
* Game progression: Score changes throughout each game
* Session analytics: Performance trends over time
📈 Google Sheets Integration
* Automatic data export: No manual exports needed
* Real-time updates: Data appears in sheets within 30 seconds
* Analytics dashboard: Auto-generated insights and trends
* Historical tracking: All games stored permanently
* Custom analysis: Full spreadsheet for your own formulas
🎯 Smart Analytics
* Performance trends: Weekly/monthly improvement tracking
* Best time analysis: Find your peak performance hours
* Weakness identification: Which operation types need work
* Streak tracking: Success streaks and patterns
* Goal monitoring: Progress toward personal bests
4Quick Setup Guide
🚀 5-Minute Complete Setup:
1. Drag bookmarklet to your bookmark bar (above)
2. Create Google Script: Copy the provided code to script.google.com
3. Deploy as Web App: Get your web app URL
4. Go to Zetamac: Click the bookmarklet to start
5. Enter Script URL: Click "Setup Sheets" in the dashboard
6. Done! Everything now runs automatically
⚡ What Happens After Setup
🎮 While Playing:
* Tracks every question & answer
* Monitors timing & accuracy
* Updates dashboard in real-time
* Runs silently in background
📊 Data Collection:
* Game scores & durations
* Question-by-question details
* Operation type breakdowns
* Response time analysis
🔄 Auto-Sync:
* Syncs every 30 seconds
* Updates Google Sheets
* Creates analytics dashboard
* Saves locally as backup
5Troubleshooting Steps
🔧 If Nothing Works:
1. Check Browser: Chrome/Firefox work best for bookmarklets
2. Disable Extensions: Ad blockers might interfere
3. Allow Popups: Ensure popups aren't blocked for zetamac.com
4. Manual Console Method: Copy the console code and paste into F12 console
5. Try Different Versions: Use the "Ultra Simple" version first
✅ Success Indicators:
* Alert popup saying "Tracker Started!" appears
* Dashboard appears in bottom-right corner of zetamac.com
* Console shows "Tracking started" message (F12 to check)
* Dashboard updates when you play games
🎯 What Each Version Does
🎯 Simple Tracker (Recommended First)
* Basic game tracking with scores and timing
* Small floating dashboard
* CSV export functionality
* Local storage backup
* Minimal code = better compatibility
📱 Ultra Simple (If Others Fail)
* Just tracks final scores
* Saves to localStorage only
* Minimal interface
* Works in almost any browser
* Good for testing if tracking works at all
📋 Manual Console Code
* Full featured tracker
* Copy-paste into browser console (F12)
* Bypasses bookmarklet limitations
* Includes Google Sheets integration
* Most reliable method if bookmarklets fail
🎮 Game Level:
* Game Key & URL
* Start & End Times
* Final Score
* Total Duration
* Questions Answered
* Overall Accuracy
❓ Question Level:
* Question Text
* Time to Solve
* Correct/Incorrect
* Score at Time
* Operation Type
* Question Number
📈 Analytics:
* Performance Trends
* Operation Breakdowns
* Response Time Stats
* Accuracy by Type
* Streak Tracking
* Best/Worst Games
3Advanced Google Sheets Analytics (Optional)
Add this additional script for automatic data analysis and insights:
function createAnalyticsDashboard() {
  const spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  let analyticsSheet = spreadsheet.getSheetByName('Analytics Dashboard');
  
  if (!analyticsSheet) {
    analyticsSheet = spreadsheet.insertSheet('Analytics Dashboard');
  }
  
  const gameSheet = spreadsheet.getSheetByName('Zetamac Games');
  if (!gameSheet || gameSheet.getLastRow() <= 1) {
    analyticsSheet.getRange(1, 1).setValue('No game data available yet.');
    return;
  }
  
  // Clear existing content
  analyticsSheet.clear();
  
  // Create analytics headers and formulas
  const analytics = [
    ['📊 ZETAMAC ANALYTICS DASHBOARD', '', '', ''],
    ['Generated:', new Date(), '', ''],
    ['', '', '', ''],
    ['🎯 PERFORMANCE SUMMARY', '', '', ''],
    ['Total Games Played:', `=COUNTA(${gameSheet.getName()}!A:A)-1`, '', ''],
    ['Best Score:', `=MAX(${gameSheet.getName()}!F:F)`, '', ''],
    ['Average Score:', `=AVERAGE(${gameSheet.getName()}!F:F)`, '', ''],
    ['Total Questions Answered:', `=SUM(${gameSheet.getName()}!G:G)`, '', ''],
    ['Average Accuracy:', `=AVERAGE(${gameSheet.getName()}!K:K)`, '%', ''],
    ['Average Game Duration:', `=AVERAGE(${gameSheet.getName()}!H:H)`, 'seconds', ''],
    ['', '', '', ''],
    ['📈 TRENDS & INSIGHTS', '', '', ''],
    ['Games This Week:', `=COUNTIF(${gameSheet.getName()}!D:D,">="&TODAY()-7)`, '', ''],
    ['Best Score This Week:', `=MAXIFS(${gameSheet.getName()}!F:F,${gameSheet.getName()}!D:D,">="&TODAY()-7)`, '', ''],
    ['Improvement Trend:', '=IF(AVERAGE(OFFSET(' + gameSheet.getName() + '!F:F,-5,0,5,1))>AVERAGE(OFFSET(' + gameSheet.getName() + '!F:F,-10,0,5,1)),"↗️ Improving","→ Stable")', '', '']
  ];
  
  // Insert analytics data
  for (let i = 0; i < analytics.length; i++) {
    analyticsSheet.getRange(i + 1, 1, 1, 4).setValues([analytics[i]]);
  }
  
  // Format the dashboard
  analyticsSheet.getRange(1, 1, 1, 4).merge().setBackground('#4CAF50').setFontColor('#FFFFFF').setFontWeight('bold').setFontSize(16);
  analyticsSheet.getRange(4, 1, 1, 4).merge().setBackground('#2196F3').setFontColor('#FFFFFF').setFontWeight('bold');
  analyticsSheet.getRange(12, 1, 1, 4).merge().setBackground('#FF9800').setFontColor('#FFFFFF').setFontWeight('bold');
  
  analyticsSheet.autoResizeColumns(1, 4);
}

// Auto-run analytics update every time new data is added
function onEdit(e) {
  const sheet = e.source.getActiveSheet();
  if (sheet.getName() === 'Zetamac Games') {
    // Delay to ensure data is fully written
    Utilities.sleep(1000);
    createAnalyticsDashboard();
  }
}

// Create a time-based trigger for regular updates
function setupAutoAnalytics() {
  // Delete existing triggers
  ScriptApp.getProjectTriggers().forEach(trigger => {
    if (trigger.getHandlerFunction() === 'createAnalyticsDashboard') {
      ScriptApp.deleteTrigger(trigger);
    }
  });
  
  // Create new trigger to update analytics every hour
  ScriptApp.newTrigger('createAnalyticsDashboard')
    .timeBased()
    .everyHours(1)
    .create();
}

        
            
1Enhanced Auto-Tracking Bookmarklet
            
This enhanced version automatically restarts when you refresh the page or start new games:
            
                ×
📊 Click \"Setup Sheets\" to enable auto-sync
0
Games
0
Best
0.0
Avg
0
Streak
Current Game: 
Waiting...
Questions: 
0
 | Score: 
0
📊 Setup Sheets
📥 CSV
📈 Stats
`;document.body.appendChild(dashboard);},startTracking(){this.isTracking=true;this.monitorGameState();console.log('Enhanced tracking started');},monitorGameState(){const checkGameState=()=>{try{const scoreElement=document.querySelector('.score');const questionElement=document.querySelector('.question');const timeElement=document.querySelector('.time_left');if(scoreElement&&questionElement&&timeElement){const currentScore=parseInt(scoreElement.textContent)||0;const currentQuestion=questionElement.textContent.trim();const timeLeft=parseInt(timeElement.textContent)||0;const gameKey=this.extractGameKey(window.location.href);if(!this.currentGame||(this.currentGame.isComplete&¤tScore>0)){this.startNewGame(gameKey);}if(this.currentGame&&!this.currentGame.isComplete){this.trackQuestion(currentQuestion,currentScore,timeLeft);}}this.updateDashboard();}catch(e){console.error('Enhanced tracking error:',e);}if(this.isTracking){setTimeout(checkGameState,100);}};checkGameState();},startNewGame(gameKey){this.currentGame={gameKey:gameKey,url:window.location.href,startTime:new Date(),questions:[],finalScore:0,isComplete:false,totalQuestions:0,operationTypes:{},questionTypes:[],avgResponseTime:0};this.questionStartTime=new Date();console.log('New enhanced game started:',gameKey);},extractGameKey(url){const match=url.match(/[?&]key=([^&]*)/);return match?match[1]:'game_'+Date.now();},trackQuestion(questionText,currentScore,timeLeft){if(!this.currentGame||this.currentGame.isComplete)return;const now=new Date();const lastQuestion=this.currentGame.questions[this.currentGame.questions.length-1];if(!lastQuestion||lastQuestion.question!==questionText){if(lastQuestion){const solveTime=(now-this.questionStartTime)/1000;lastQuestion.timeToSolve=solveTime;lastQuestion.wasCorrect=currentScore>this.currentGame.finalScore;this.analyzeQuestion(lastQuestion);}this.currentGame.questions.push({question:questionText,timestamp:now,score:currentScore,timeLeft:timeLeft,timeToSolve:null,wasCorrect:null,questionNumber:this.currentGame.questions.length+1});this.questionStartTime=now;}this.currentGame.finalScore=currentScore;this.currentGame.totalQuestions=this.currentGame.questions.length;if(timeLeft===0&&!this.currentGame.isComplete){this.completeGame();}},analyzeQuestion(question){const operationType=this.detectOperationType(question.question);if(operationType){this.currentGame.operationTypes[operationType]=(this.currentGame.operationTypes[operationType]||0)+1;}this.currentGame.questionTypes.push({type:operationType,correct:question.wasCorrect,time:question.timeToSolve});},detectOperationType(questionText){if(questionText.includes('×')||questionText.includes('*'))return'multiplication';if(questionText.includes('÷')||questionText.includes('/'))return'division';if(questionText.includes('+'))return'addition';if(questionText.includes('-'))return'subtraction';return'unknown';},completeGame(){if(!this.currentGame||this.currentGame.isComplete)return;this.currentGame.endTime=new Date();this.currentGame.isComplete=true;this.currentGame.duration=(this.currentGame.endTime-this.currentGame.startTime)/1000;const responseTimes=this.currentGame.questions.filter(q=>q.timeToSolve).map(q=>q.timeToSolve);this.currentGame.avgResponseTime=responseTimes.length>0?responseTimes.reduce((a,b)=>a+b,0)/responseTimes.length:0;if(this.currentGame.questions.length>0){const lastQuestion=this.currentGame.questions[this.currentGame.questions.length-1];if(lastQuestion.timeToSolve===null){lastQuestion.timeToSolve=(this.currentGame.endTime-this.questionStartTime)/1000;lastQuestion.wasCorrect=true;}}this.gameData.push({...this.currentGame});this.saveToLocalStorage();this.syncToGoogleSheets();console.log('Enhanced game completed. Total games:',this.gameData.length);},updateDashboard(){const stats=this.calculateStats();document.getElementById('games-count').textContent=stats.totalGames;document.getElementById('best-score').textContent=stats.bestScore;document.getElementById('avg-score').textContent=stats.avgScore.toFixed(1);document.getElementById('current-streak').textContent=stats.currentStreak;if(this.currentGame){document.getElementById('current-status').textContent=this.currentGame.isComplete?'Completed':'In Progress';document.getElementById('current-questions').textContent=this.currentGame.totalQuestions;document.getElementById('current-score').textContent=this.currentGame.finalScore;}const syncStatus=document.getElementById('sync-status');if(this.autoSyncEnabled){syncStatus.innerHTML='✅ Auto-sync enabled - Data syncing to Google Sheets';syncStatus.style.background='rgba(76,175,80,0.2)';}},calculateStats(){const completed=this.gameData.filter(g=>g.isComplete);const totalGames=completed.length;const bestScore=totalGames>0?Math.max(...completed.map(g=>g.finalScore)):0;const avgScore=totalGames>0?completed.reduce((sum,g)=>sum+g.finalScore,0)/totalGames:0;return{totalGames,bestScore,avgScore,currentStreak:this.getCurrentStreak()};},getCurrentStreak(){let streak=0;for(let i=this.gameData.length-1;i>=0;i--){if(this.gameData[i].isComplete&&this.gameData[i].finalScore>0){streak++;}else{break;}}return streak;},setupGoogleSheets(){const url=prompt('Enter your Google Apps Script Web App URL:\\n(Leave blank to set up later)');if(url){this.googleScriptUrl=url.trim();this.autoSyncEnabled=true;this.saveSettings();this.startAutoSync();alert('✅ Google Sheets integration enabled!\\nData will now auto-sync every 30 seconds.');}else{alert('You can set this up later by clicking \"Setup Sheets\" again.');}},startAutoSync(){if(this.syncInterval){clearInterval(this.syncInterval);}if(this.autoSyncEnabled&&this.googleScriptUrl){this.syncInterval=setInterval(()=>{this.syncToGoogleSheets();},30000);console.log('Auto-sync started - every 30 seconds');}},syncToGoogleSheets(){if(!this.autoSyncEnabled||!this.googleScriptUrl||this.gameData.length===0)return;const unsyncedGames=this.gameData.filter(g=>!g.synced);if(unsyncedGames.length===0)return;const payload={games:unsyncedGames.map(game=>({gameKey:game.gameKey,url:game.url,startTime:game.startTime.toISOString(),endTime:game.endTime?game.endTime.toISOString():'',finalScore:game.finalScore,totalQuestions:game.totalQuestions,duration:game.duration||0,avgResponseTime:game.avgResponseTime||0,operationBreakdown:JSON.stringify(game.operationTypes||{}),accuracy:game.questions.filter(q=>q.wasCorrect).length/Math.max(game.questions.length,1)*100}))};fetch(this.googleScriptUrl,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)}).then(response=>response.json()).then(data=>{if(data.success){unsyncedGames.forEach(game=>game.synced=true);this.saveToLocalStorage();console.log('Synced',unsyncedGames.length,'games to Google Sheets');}}).catch(error=>{console.error('Sync error:',error);});},exportToCSV(){const csvData=[['Game Key','URL','Start Time','End Time','Final Score','Questions','Duration','Avg Response Time','Operation Breakdown','Accuracy %']];this.gameData.filter(g=>g.isComplete).forEach(game=>{const accuracy=game.questions.filter(q=>q.wasCorrect).length/Math.max(game.questions.length,1)*100;csvData.push([game.gameKey,game.url,game.startTime.toISOString(),game.endTime?game.endTime.toISOString():'',game.finalScore,game.totalQuestions,game.duration||0,game.avgResponseTime||0,JSON.stringify(game.operationTypes||{}),accuracy.toFixed(1)]);});const csvContent='data:text/csv;charset=utf-8,'+csvData.map(row=>row.map(cell=>`\"${cell}\"`).join(',')).join('\\n');const link=document.createElement('a');link.setAttribute('href',encodeURI(csvContent));link.setAttribute('download',`zetamac-enhanced-${new Date().toISOString().split('T')[0]}.csv`);link.click();alert('📥 Enhanced CSV exported with detailed analytics!');},showDetailedStats(){const modal=document.createElement('div');modal.className='stats-modal';modal.innerHTML=`
📊 Enhanced Analytics Dashboard
×

`;const content=modal.querySelector('#detailed-stats-content');const stats=this.calculateEnhancedStats();content.innerHTML=stats;document.body.appendChild(modal);},calculateEnhancedStats(){const completed=this.gameData.filter(g=>g.isComplete);if(completed.length===0)return'
No completed games yet. Play some games to see detailed stats!
';const totalQuestions=completed.reduce((sum,g)=>sum+g.totalQuestions,0);const totalCorrect=completed.reduce((sum,g)=>sum+g.questions.filter(q=>q.wasCorrect).length,0);const overallAccuracy=totalQuestions>0?(totalCorrect/totalQuestions*100):0;const avgGameDuration=completed.reduce((sum,g)=>sum+(g.duration||0),0)/completed.length;const operationStats={};completed.forEach(game=>{Object.entries(game.operationTypes||{}).forEach(([op,count])=>{operationStats[op]=(operationStats[op]||0)+count;});});const recentGames=completed.slice(-5).reverse();return`
${completed.length}
Total Games
${overallAccuracy.toFixed(1)}%
Overall Accuracy
${avgGameDuration.toFixed(1)}s
Avg Game Duration
${totalQuestions}
Total Questions
📈 Operation Breakdown
${Object.entries(operationStats).map(([op,count])=>`
${Op}
${count}
`).join('')}
🎯 Recent Games
${recentGames.map((game,i)=>`
Game ${recentGames.length-i}
Score: ${game.finalScore}
${game.totalQuestions} questions • ${(game.duration||0).toFixed(1)}s • ${game.startTime.toLocaleDateString()}
`).join('')}
`;},saveToLocalStorage(){try{localStorage.setItem('zetamac-tracker-data',JSON.stringify(this.gameData));}catch(e){console.error('localStorage save error:',e);}},loadFromLocalStorage(){try{const saved=localStorage.getItem('zetamac-tracker-data');if(saved){this.gameData=JSON.parse(saved);this.gameData.forEach(game=>{if(game.startTime&&typeof game.startTime==='string'){game.startTime=new Date(game.startTime);}if(game.endTime&&typeof game.endTime==='string'){game.endTime=new Date(game.endTime);}});console.log('Loaded',this.gameData.length,'games from storage');}}catch(e){console.error('localStorage load error:',e);}},injectStyles(){const style=document.createElement('style');style.textContent=`#zetamac-dashboard *{box-sizing:border-box !important;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif !important;}`;document.head.appendChild(style);}};tracker.loadFromLocalStorage();tracker.init();window.zetamacTracker=tracker;})();" class="bookmarklet">🚀 Enhanced Auto-Tracker
            
Key Enhancements:
* ✅ Auto-restarts when you refresh the page or start new games
* 📊 Enhanced analytics - tracks operation types, accuracy, response times
* 🔄 Auto-sync to Google Sheets every 30 seconds
* 💾 Persistent settings - remembers your Google Sheet URL
* 🎯 Real-time dashboard with current game status
2Google Apps Script Setup
Create this script to automatically receive and store your Zetamac data:
📋 Instructions:
1. Go to script.google.com
2. Click "New Project"
3. Replace the default code with the script below
4. Save the project (Ctrl+S)
5. Click "Deploy" → "New deployment"
6. Choose "Web app" → Execute as "Me" → Access "Anyone"
7. Copy the Web App URL
function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    const sheet = getOrCreateSheet();
    
    // Add headers if sheet is empty
    if (sheet.getLastRow() === 0) {
      sheet.appendRow([
        'Timestamp', 'Game Key', 'URL', 'Start Time', 'End Time', 
        'Final Score', 'Total Questions', 'Duration (s)', 'Avg Response Time', 
        'Operation Breakdown', 'Accuracy %', 'Sync Date'
      ]);
      
      // Format headers
      const headerRange = sheet.getRange(1, 1, 1, 12);
      headerRange.setBackground('#4CAF50');
      headerRange.setFontColor('#FFFFFF');
      headerRange.setFontWeight('bold');
    }
    
    // Process each game
    data.games.forEach(game => {
      sheet.appendRow([
        new Date().toISOString(),
        game.gameKey,
        game.url,
        game.startTime,
        game.endTime,
        game.finalScore,
        game.totalQuestions,
        game.duration,
        game.avgResponseTime,
        game.operationBreakdown,
        game.accuracy,
        new Date()
      ]);
    });
    
    // Auto-resize columns for better readability
    sheet.autoResizeColumns(1, 12);
    
    return ContentService
      .createTextOutput(JSON.stringify({success: true, processed: data.games.length}))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    console.error('Error processing data:', error);
    return ContentService
      .createTextOutput(JSON.stringify({success: false, error: error.toString()}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}

function getOrCreateSheet() {
  const spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  let sheet = spreadsheet.getSheetByName('Zetamac Games');
  
  if (!sheet) {
    sheet = spreadsheet.insertSheet('Zetamac Games');
  }
  
  return sheet;
}

function doGet() {
  return HtmlService.createHtmlOutput(`
    
Zetamac Tracker - Google Apps Script
    
✅ Script is working! Your Zetamac data will appear here automatically.
    
Last updated: ${new Date()}
  `);
}
